---
# Reference: https://github.com/linkedin/cruise-control#environment-requirements
# The main branch of Cruise Control is compatible with:
# - Kafka 2.5+ (Releases 2.5.*)
# - Kafka 2.6  (Releases 2.5.11+)
# - Kafka 2.7  (Releases 2.5.36+)
# - Kafka 2.8  (Releases 2.5.66+)
# - Kafka 3.0  (Releases 2.5.85+)
# - Kafka 3.1  (Releases 2.5.85+)
# - Kafka 3.8  (Releases 2.5.142+)
# - Kafka 3.9  (Releases 2.5.143+)
# - Kafka 4.0  (Releases 2.5.144+)

scms:
  cruise-control:
    kind: github
    spec:
        owner: "linkedin"
        repository: "cruise-control"
        token: {{ requiredEnv "GITHUB_TOKEN" }}
        branch: "main"
sources:
  aws-msk-iam-auth:
    kind: githubrelease
    spec:
      owner: "aws"
      repository: "aws-msk-iam-auth"
      token: {{ requiredEnv "GITHUB_TOKEN" }}
      versionFilter:
        kind: semver
    transformers:
      - trimprefix: "v"
  cruise-control:
    kind: gittag
    scmid: cruise-control
    spec:
      versionfilter:
        kind: semver
        pattern: "~2"
  cruise-control-ui:
    kind: githubrelease
    spec:
      owner: "linkedin"
      repository: "cruise-control-ui"
      token: {{ requiredEnv "GITHUB_TOKEN" }}
      versionFilter:
        kind: semver
    transformers:
      - trimprefix: "v"
conditions: {}
targets:
  update-aws-msk-iam-auth-version:
    name: "Update the value of ARG AWS_MSK_IAM_AUTH_VERSION in the Dockerfile"
    sourceid: aws-msk-iam-auth
    kind: dockerfile
    spec:
      file: Dockerfile
      instruction:
        keyword: "ARG"
        matcher: "AWS_MSK_IAM_AUTH_VERSION"
  update-cc-tag:
    name: "Update the value of ARG CC_TAG in the Dockerfile"
    sourceid: cruise-control
    kind: dockerfile
    spec:
      file: Dockerfile
      instruction:
        keyword: "ARG"
        matcher: "CC_TAG"
  update-cc-ui-tag:
    name: "Update the value of ARG CC_UI_TAG in the Dockerfile"
    sourceid: cruise-control-ui
    kind: dockerfile
    spec:
      file: Dockerfile
      instruction:
        keyword: "ARG"
        matcher: "CC_UI_TAG"
